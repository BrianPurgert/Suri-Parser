<!DOCTYPE html>
<html >

<head >
  <script type = "importmap" >
  {
    "imports": {
      "vue": "https://unpkg.com/vue@3.3.4/dist/vue.esm-browser.js",
      "vue/server-renderer": "https://unpkg.com/@vue/server-renderer@3.3.4/dist/server-renderer.esm-browser.js"
    }
  }

  </script >
</head >

<!--
This example fetches latest Vue.js commits data from GitHubâ€™s API and displays them as a list.
You can switch between the two branches.
-->

<script type = "module" >
	import { createApp, ref, watchEffect } from 'vue'

	const API_URL = `/api?url=`
	const branches = ['main', 'v2-compat']

	createApp({
		setup() {
			const currentBranch = ref(branches[0])
			const commits = ref(null)

			watchEffect(async () => {
				// this effect will run immediately and then
				// re-run whenever currentBranch.value changes
				const url = `${ API_URL }${ currentBranch.value }`
				commits.value = await (await fetch(url)).json()
			})

			function truncate(v) {
				const newline = v.indexOf('\n')
				return newline > 0 ? v.slice(0, newline) : v
			}

			function formatDate(v) {
				return v.replace(/T|Z/g, ' ')
			}

			return {
				branches,
				currentBranch,
				commits,
				truncate,
				formatDate
			}
		}
	}).mount('#app')
</script >

<div id = "app" >

  <template v-for = "branch in branches" >
    <input type = "text"
      :id = "branch"
      :value = "branch"
      name = "branch"
      v-model = "currentBranch" >
    <label :for = "branch" >{{ branch }}</label >
  </template >


</div >


</html >
